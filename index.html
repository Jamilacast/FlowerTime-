<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ğŸŒ¸ FlowerTime â€” Organiza tu tiempo</title>
  <style>
    :root{--bg:#fff6fb;--accent:#d6336c;--muted:#6b7280}
    html,body{height:100%;margin:0;font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,"Helvetica Neue",Arial}
    body{background:linear-gradient(135deg,#fff7fb 0%, #f0fff6 100%);padding:24px}
    .container{max-width:1100px;margin:0 auto}
    h1{color:var(--accent);font-size:28px;margin:0 0 18px}
    .grid{display:grid;grid-template-columns:repeat(12,1fr);gap:16px}
    .card{background:white;border-radius:16px;padding:18px;box-shadow:0 6px 18px rgba(0,0,0,0.06)}
    .col-5{grid-column:span 5}
    .col-4{grid-column:span 4}
    .col-3{grid-column:span 3}
    .col-7{grid-column:span 7}
    .title-sm{font-weight:600;margin-bottom:8px}
    button{cursor:pointer}
    .btn-primary{background:var(--accent);color:white;border:none;padding:8px 12px;border-radius:8px}
    .btn-muted{background:white;border:1px solid #e5e7eb;padding:8px 12px;border-radius:8px}
    input[type="text"],input[type="date"],textarea{width:100%;padding:8px;border-radius:8px;border:1px solid #e6e6e6;margin-bottom:8px}
    .pomodoro-time{font-family:monospace;font-size:40px;text-align:center;margin:12px 0}
    .calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:8px}
    .day{min-height:72px;padding:8px;border-radius:8px;border:1px solid #eee;background:#fff;cursor:pointer}
    .date{font-size:12px;color:var(--muted);font-weight:600}
    .task-line{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;background:#fbfbfc;margin-bottom:8px}
    .muted{color:var(--muted);font-size:13px}
    @media (max-width:900px){
      .grid{grid-template-columns:1fr}
      .col-5,.col-4,.col-3,.col-7{grid-column:1}
    }
  </style>
</head>
<body>
  <div class="container">
    <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;">
      <h1 id="mainTitle">ğŸŒ¸ FlowerTime â€” Organiza tu tiempo</h1>
      <button id="themeConfigBtn" title="Cambiar temÃ¡tica" style="background:none;border:none;font-size:26px;cursor:pointer;outline:none;">âš™ï¸</button>
    </div>
    <div id="themeSelector" style="display:none;position:absolute;top:54px;right:32px;background:#fff6fb;border:2px solid #d6336c;border-radius:14px;box-shadow:0 4px 16px #d6336c22;padding:18px 22px;z-index:2000;">
      <div style="font-weight:bold;color:#d6336c;font-size:17px;margin-bottom:10px;">Elige una temÃ¡tica:</div>
      <button class="theme-btn" data-theme="flores" style="display:block;width:100%;margin-bottom:8px;font-size:17px;">ğŸŒ¸ Flores</button>
      <button class="theme-btn" data-theme="mar" style="display:block;width:100%;margin-bottom:8px;font-size:17px;">ğŸŒŠ Mar y ocÃ©ano</button>
      <button class="theme-btn" data-theme="luna" style="display:block;width:100%;font-size:17px;">ğŸŒ™ Lunas y constelaciones</button>
    </div>
  <script>
  // TemÃ¡ticas disponibles
  document.addEventListener('DOMContentLoaded', function(){
  const THEMES = {
    flores: {
      '--bg':'#fff6fb', '--accent':'#d6336c', '--muted':'#6b7280',
      title:'ğŸŒ¸ FlowerTime â€” Organiza tu tiempo',
      nav1:'ğŸŒ»', nav2:'ğŸŒ¸',
  bgGradient:'linear-gradient(135deg,#fff7fb 0%, #f0fff6 100%)',
  bgImage: `url('data:image/svg+xml;utf8,<svg width="600" height="600" xmlns="http://www.w3.org/2000/svg"><text x="40" y="120" font-size="90" opacity=".13">ğŸŒ¸ğŸŒ·ğŸŒº</text><text x="300" y="500" font-size="110" opacity=".10">ğŸŒ»ğŸŒ¼</text></svg>')`,
      streakBg:'#ffe3ef', streakBorder:'#d6336c', streakText:'#d6336c', monthColor:'#d6336c'
    },
    mar: {
      '--bg':'#e0f7fa', '--accent':'#0077b6', '--muted':'#006080',
      title:'ğŸŒŠ OceanTime â€” Organiza tu tiempo',
      nav1:'ğŸš', nav2:'ğŸŒŠ',
  bgGradient:'linear-gradient(135deg,#e0f7fa 0%, #b2ebf2 100%)',
  bgImage: `url('data:image/svg+xml;utf8,<svg width="600" height="600" xmlns="http://www.w3.org/2000/svg"><text x="40" y="120" font-size="90" opacity=".13">ğŸŸğŸ ğŸ¬</text><text x="300" y="500" font-size="110" opacity=".10">ğŸ³ğŸ‹</text></svg>')`,
      streakBg:'#b2ebf2', streakBorder:'#0077b6', streakText:'#0077b6', monthColor:'#0077b6'
    },
    luna: {
      '--bg':'#f3f0ff', '--accent':'#5f3dc4', '--muted':'#6c757d',
      title:'ğŸŒ™ MoonTime â€” Organiza tu tiempo',
      nav1:'ğŸŒ ', nav2:'ğŸŒ™',
  bgGradient:'linear-gradient(135deg,#f3f0ff 0%, #dee2ff 100%)',
  bgImage: `url('data:image/svg+xml;utf8,<svg width="600" height="600" xmlns="http://www.w3.org/2000/svg"><text x="40" y="120" font-size="90" opacity=".13">ğŸŒ™âœ¨</text><text x="300" y="500" font-size="110" opacity=".10">ğŸŒŸğŸ”­</text></svg>')`,
      streakBg:'#e5dbff', streakBorder:'#5f3dc4', streakText:'#5f3dc4', monthColor:'#5f3dc4'
    }
  };

  function applyTheme(themeKey) {
    const theme = THEMES[themeKey] || THEMES.flores;
    for(const v in theme) {
      if(v.startsWith('--')) document.documentElement.style.setProperty(v, theme[v]);
    }
    document.body.style.background = theme.bgGradient;
    document.body.style.backgroundImage = theme.bgImage;
    document.body.style.backgroundRepeat = 'no-repeat';
    document.body.style.backgroundPosition = 'bottom right';
    document.body.style.backgroundSize = 'contain';
    // Fondo decorativo tambiÃ©n en el calendario
    const calCard = document.querySelector('.card.col-12');
    if(calCard) {
      calCard.style.background = theme.bgGradient;
      calCard.style.backgroundImage = theme.bgImage;
      calCard.style.backgroundRepeat = 'no-repeat';
      calCard.style.backgroundPosition = 'bottom right';
      calCard.style.backgroundSize = 'contain';
    }
    document.getElementById('mainTitle').innerText = theme.title;
    // Cambiar Ã­conos de navegaciÃ³n
    document.getElementById('prevYear').innerText = theme.nav1;
    document.getElementById('nextYear').innerText = theme.nav1;
    document.getElementById('prevMonth').innerText = theme.nav2;
    document.getElementById('nextMonth').innerText = theme.nav2;
    // Cambiar color del mes
    const label = document.getElementById('calendarLabel');
    if(label) label.style.color = theme.monthColor;
    // Cambiar color de la racha
    const streak = document.getElementById('streakContainer');
    if(streak) {
      const box = streak.querySelector('div');
      if(box) {
        box.style.background = theme.streakBg;
        box.style.borderColor = theme.streakBorder;
        box.style.color = theme.streakText;
        // Cambiar color de los textos internos
        const strongs = box.querySelectorAll('div');
        strongs.forEach(el=>el.style.color=theme.streakText);
      }
    }
    localStorage.setItem('theme', themeKey);
  }

  // Mostrar/ocultar selector
  document.getElementById('themeConfigBtn').onclick = function(e) {
    e.stopPropagation();
    const sel = document.getElementById('themeSelector');
    sel.style.display = sel.style.display==='block' ? 'none' : 'block';
  };
  // Cerrar selector al hacer clic fuera
  document.addEventListener('click', function(e){
    const sel = document.getElementById('themeSelector');
    const btn = document.getElementById('themeConfigBtn');
    if(sel.style.display==='block' && !sel.contains(e.target) && e.target!==btn) sel.style.display='none';
  });
  // SelecciÃ³n de tema
  document.querySelectorAll('.theme-btn').forEach(btn=>{
    btn.onclick = function(e){ e.stopPropagation(); applyTheme(btn.dataset.theme); document.getElementById('themeSelector').style.display='none'; };
  });
  // Aplicar tema guardado
  const savedTheme = localStorage.getItem('theme') || 'flores';
  setTimeout(()=>applyTheme(savedTheme), 0);
  });
  </script>
  
  <!-- El resto del script ya estÃ¡ incluido en el HTML completo (extraÃ­do de flowertime.html) -->

    <div class="grid">
      <!-- Lista de tareas -->
      <div class="card col-4">
  <div id="streakContainer" style="margin-bottom:18px;"></div>
        <div class="title-sm">âœ… Lista de pendientes</div>
        <input type="text" id="taskInput" placeholder="Nueva tarea..."/>
        <button class="btn-primary" onclick="addTask()">Agregar</button>
        <div id="taskList"></div>
      </div>

      <!-- Pomodoro -->
      <div class="card col-4">
        <div class="title-sm">â³ Pomodoro</div>
        <div id="pomodoro" class="pomodoro-time">25:00</div>
        <button class="btn-primary" onclick="startPomodoro()">Iniciar</button>
        <button class="btn-muted" onclick="resetPomodoro()">Reiniciar</button>
      </div>

      <!-- Asistente IA -->
      <div class="card col-4">
        <div class="title-sm">ğŸ¤– Asistente de estudio</div>
        <textarea id="aiInput" placeholder="Hazme una pregunta sobre tÃ©cnicas de estudio..."></textarea>
        <button class="btn-primary" onclick="askAI()">Preguntar</button>
        <div id="aiOutput" class="muted"></div>
      </div>
    </div>

    <!-- Calendario -->
    <div class="card col-12" style="margin-top:20px">
      <div class="title-sm">ğŸ“… Calendario</div>
      <div style="display:flex;align-items:center;justify-content:center;margin-bottom:10px;gap:10px;">
        <button id="prevYear" class="btn-flower-nav" title="AÃ±o anterior">ğŸŒ»</button>
        <button id="prevMonth" class="btn-flower-nav" title="Mes anterior">ğŸŒ¸</button>
        <span id="calendarLabel" style="font-weight:bold;font-size:18px;color:#d6336c;min-width:120px;text-align:center;display:inline-block;flex:1;"></span>
        <button id="nextMonth" class="btn-flower-nav" title="Mes siguiente">ğŸŒ¸</button>
        <button id="nextYear" class="btn-flower-nav" title="AÃ±o siguiente">ğŸŒ»</button>
      </div>
      <div class="calendar" id="calendar"></div>
    </div>
  </div>

  <script>
    // ====== Lista de tareas ======
    function addTask(){
      const input = document.getElementById('taskInput');
      const text = input.value.trim();
      if(!text) return;
      const taskList = document.getElementById('taskList');
      const div = document.createElement('div');
      div.className = 'task-line';
      // BotÃ³n de cumplida (âœ…) y eliminar (âŒ)
      div.innerHTML = '<span>'+text+'</span>'+
        '<div>'+
        '<button class="btn-streak" onclick="completeTask(this)" title="Marcar como cumplida">âœ…</button> '+
        '<button onclick="this.parentNode.parentNode.remove()">âŒ</button>'+
        '</div>';
      taskList.appendChild(div);
      input.value = '';
    }
    // Marcar tarea como cumplida y actualizar racha
    function completeTask(btn) {
      // Solo permitir una vez por dÃ­a
      if (localStorage.getItem('streak_lastDay') === getTodayStr()) {
        alert('Â¡Ya registraste tu tarea cumplida hoy!');
        return;
      }
      btn.disabled = true;
      btn.innerText = 'ğŸ‰';
      updateStreak();
    }
    // ====== Racha de tareas ======
    function getTodayStr() {
      const today = new Date();
      return today.getFullYear() + '-' + (today.getMonth()+1).toString().padStart(2,'0') + '-' + today.getDate().toString().padStart(2,'0');
    }

    function updateStreak() {
      const today = getTodayStr();
      let lastDay = localStorage.getItem('streak_lastDay');
      let streak = parseInt(localStorage.getItem('streak_count') || '0');
      if (lastDay === today) {
        // Ya se registrÃ³ hoy, no aumentar racha
        showStreak(streak);
        return;
      }
      if (lastDay) {
        const last = new Date(lastDay);
        const now = new Date(today);
        const diff = (now - last) / (1000*60*60*24);
        if (diff === 1) {
          streak += 1;
        } else {
          streak = 1;
        }
      } else {
        streak = 1;
      }
      localStorage.setItem('streak_lastDay', today);
      localStorage.setItem('streak_count', streak);
      showStreak(streak);
    }

    function showStreak(streak) {
      const theme = THEMES[localStorage.getItem('theme') || 'flores'];
      const el = document.getElementById('streakContainer');
      el.innerHTML = `
        <div style="background: ${theme.streakBg}; border-radius: 14px; padding: 18px; box-shadow: 0 2px 8px ${theme.streakBorder}22; text-align: center; border: 2px solid ${theme.streakBorder}; max-width: 300px; margin: 0 auto 10px auto; color:${theme.streakText};">
          <div style="font-size: 18px; font-weight: bold; color: ${theme.streakText}; margin-bottom: 6px;">Racha</div>
          <div style="font-size: 32px; font-weight: bold; color: ${theme.streakText};">ğŸ”¥ ${streak} dÃ­a${streak === 1 ? '' : 's'}</div>
          <div style="color: #6b7280; font-size: 15px; margin-top: 8px;">Â¡Sigue asÃ­! Cada dÃ­a cuenta para tu progreso ğŸŒ±</div>
        </div>
      `;
    }
  // Estilos para el botÃ³n de racha
  const style = document.createElement('style');
  style.innerHTML = `.btn-streak { background: #fff6fb; color: #d6336c; border: 1px solid #d6336c; border-radius: 8px; padding: 4px 10px; margin-right: 4px; font-size: 18px; cursor: pointer; transition: background 0.2s; } .btn-streak:disabled { background: #ffe3ef; color: #aaa; border-color: #ffe3ef; cursor: default; }`;
  document.head.appendChild(style);

    // Mostrar racha al cargar
    document.addEventListener('DOMContentLoaded', function() {
      const streak = parseInt(localStorage.getItem('streak_count') || '0');
      showStreak(streak);
    });

    // ====== Pomodoro ======
    let timer;
    let timeLeft = 25*60;
    function updatePomodoro(){
      const min = String(Math.floor(timeLeft/60)).padStart(2,'0');
      const sec = String(timeLeft%60).padStart(2,'0');
      document.getElementById('pomodoro').innerText = min+':'+sec;
    }
    function startPomodoro(){
      if(timer) return;
      timer = setInterval(()=>{
        if(timeLeft>0){timeLeft--;updatePomodoro();}
        else{clearInterval(timer);timer=null;alert('Â¡Tiempo terminado!');}
      },1000);
    }
    function resetPomodoro(){
      clearInterval(timer);timer=null;timeLeft=25*60;updatePomodoro();
    }
    updatePomodoro();

    // ====== Calendario Mejorado ======
    let currentMonth = (new Date()).getMonth();
    let currentYear = (new Date()).getFullYear();

    function getMonthName(month) {
      const meses = ['Enero','Febrero','Marzo','Abril','Mayo','Junio','Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'];
      return meses[month];
    }

    function daysInMonth(month, year) {
      return new Date(year, month+1, 0).getDate();
    }

    function generateCalendar() {
      const cal = document.getElementById('calendar');
      cal.innerHTML = '';
      const label = document.getElementById('calendarLabel');
      if(label) {
        label.style.display = 'inline-block';
        label.textContent = getMonthName(currentMonth) + ' ' + currentYear;
      }
      const firstDay = new Date(currentYear, currentMonth, 1).getDay();
      const totalDays = daysInMonth(currentMonth, currentYear);
      // Ajustar para que el calendario empiece en lunes
      let start = firstDay === 0 ? 6 : firstDay - 1;
      for(let i=0;i<start;i++){
        const empty = document.createElement('div');
        empty.className = 'day';
        empty.style.background = 'transparent';
        empty.style.border = 'none';
        cal.appendChild(empty);
      }
      // Cargar tareas del mes actual
      const key = `calendar-tasks-${currentYear}-${currentMonth}`;
      let monthTasks = {};
      try { monthTasks = JSON.parse(localStorage.getItem(key) || '{}'); } catch(e) {}
      for(let i=1;i<=totalDays;i++){
        const day = document.createElement('div');
        day.className = 'day';
        day.innerHTML = '<div class="date">'+i+'</div>';
        // Mostrar tareas si existen
        if(monthTasks[i] && monthTasks[i].length > 0) {
          const taskList = document.createElement('ul');
          taskList.style.listStyle = 'none';
          taskList.style.padding = '0';
          taskList.style.margin = '6px 0 0 0';
          monthTasks[i].forEach((task, idx) => {
            const li = document.createElement('li');
            li.style.fontSize = '13px';
            li.style.background = '#ffe3ef';
            li.style.color = '#d6336c';
            li.style.borderRadius = '7px';
            li.style.marginBottom = '3px';
            li.style.padding = '2px 6px 2px 6px';
            li.style.display = 'flex';
            li.style.alignItems = 'center';
            li.style.justifyContent = 'space-between';
            li.innerHTML = `<span><span style='font-weight:bold;'>${task.title}</span>` + (task.hour ? ` <span style='font-size:12px;color:#6b7280;'>â° ${task.hour}</span>` : '') + `</span>`;
            // BotÃ³n editar
            const editBtn = document.createElement('button');
            editBtn.innerHTML = 'âœï¸';
            editBtn.title = 'Editar tarea';
            editBtn.style.background = 'none';
            editBtn.style.border = 'none';
            editBtn.style.cursor = 'pointer';
            editBtn.style.fontSize = '16px';
            editBtn.style.marginRight = '6px';
            editBtn.onclick = function(e) {
              e.stopPropagation();
              editCalendarTask(currentYear, currentMonth, i, idx, task);
            };
            li.appendChild(editBtn);
            // BotÃ³n eliminar
            const delBtn = document.createElement('button');
            delBtn.innerHTML = 'ğŸ—‘ï¸';
            delBtn.title = 'Eliminar tarea';
            delBtn.style.background = 'none';
            delBtn.style.border = 'none';
            delBtn.style.cursor = 'pointer';
            delBtn.style.fontSize = '16px';
            delBtn.onclick = function(e) {
              e.stopPropagation();
              deleteCalendarTask(currentYear, currentMonth, i, idx);
            };
            li.appendChild(delBtn);
            taskList.appendChild(li);
          });
// Editar tarea del calendario
function editCalendarTask(year, month, dayNum, taskIdx, task) {
  if(document.getElementById('calendarTaskForm')) return;
  const form = document.createElement('div');
  form.id = 'calendarTaskForm';
  form.style.position = 'fixed';
  form.style.left = '50%';
  form.style.top = '50%';
  form.style.transform = 'translate(-50%,-50%)';
  form.style.background = '#fff6fb';
  form.style.border = '2px solid #d6336c';
  form.style.boxShadow = '0 6px 18px #d6336c22';
  form.style.padding = '22px 18px 18px 18px';
  form.style.zIndex = 1000;
  form.innerHTML = `
    <div style='font-weight:bold;color:#d6336c;font-size:18px;margin-bottom:10px;'>Editar tarea para el ${dayNum} de ${getMonthName(month)} ${year}</div>
    <input id='taskTitleInput' type='text' placeholder='TÃ­tulo de la tarea' value="${task.title.replace(/"/g, '&quot;')}" style='width:100%;margin-bottom:8px;padding:7px;border-radius:8px;border:1px solid #e6e6e6;'>
    <input id='taskHourInput' type='time' value="${task.hour || ''}" style='width:100%;margin-bottom:8px;padding:7px;border-radius:8px;border:1px solid #e6e6e6;'>
    <select id='taskAlarmInput' style='width:100%;margin-bottom:8px;padding:7px;border-radius:8px;border:1px solid #e6e6e6;'>
      <option value='10' ${task.alarm==10?'selected':''}>Alarma 10 minutos antes</option>
      <option value='20' ${task.alarm==20?'selected':''}>Alarma 20 minutos antes</option>
      <option value='180' ${task.alarm==180?'selected':''}>Alarma 3 horas antes</option>
      <option value='0' ${!task.alarm?'selected':''}>Sin alarma</option>
    </select>
    <select id='taskSoundInput' style='width:100%;margin-bottom:8px;padding:7px;border-radius:8px;border:1px solid #e6e6e6;'>
      <option value='bell' ${task.sound==='bell'?'selected':''}>ğŸ”” Campana</option>
      <option value='ding' ${task.sound==='ding'?'selected':''}>ğŸµ Timbre</option>
      <option value='soft' ${task.sound==='soft'?'selected':''}>ğŸŒ¸ MelodÃ­a suave</option>
    </select>
    <div style='font-size:13px;color:#6b7280;margin-bottom:10px;'>La hora de entrega, la alarma y el sonido son opcionales</div>
    <button id='saveEditTaskBtn' class='btn-primary' style='width:100%;margin-bottom:6px;'>Guardar cambios</button>
    <button id='cancelEditTaskBtn' class='btn-muted' style='width:100%;'>Cancelar</button>
  `;
  document.body.appendChild(form);
  document.getElementById('taskTitleInput').focus();
  document.getElementById('cancelEditTaskBtn').onclick = function() {
    form.remove();
  };
  document.getElementById('saveEditTaskBtn').onclick = function() {
    const title = document.getElementById('taskTitleInput').value.trim();
    const hour = document.getElementById('taskHourInput').value;
    const alarm = parseInt(document.getElementById('taskAlarmInput').value);
    const sound = document.getElementById('taskSoundInput').value;
    if(!title) { alert('Por favor, escribe un tÃ­tulo para la tarea.'); return; }
    const key = `calendar-tasks-${year}-${month}`;
    let tasks = JSON.parse(localStorage.getItem(key) || '{}');
    if(tasks[dayNum] && tasks[dayNum][taskIdx]) {
      tasks[dayNum][taskIdx] = {title, hour, alarm, sound};
      localStorage.setItem(key, JSON.stringify(tasks));
      form.remove();
      generateCalendar();
    }
  };
}
// Eliminar tarea del calendario
function deleteCalendarTask(year, month, dayNum, taskIdx) {
  const key = `calendar-tasks-${year}-${month}`;
  let tasks = JSON.parse(localStorage.getItem(key) || '{}');
  if(tasks[dayNum]) {
    tasks[dayNum].splice(taskIdx, 1);
    if(tasks[dayNum].length === 0) {
      delete tasks[dayNum];
    }
    localStorage.setItem(key, JSON.stringify(tasks));
    generateCalendar();
  }
}
          day.appendChild(taskList);
        }
        day.onclick = function(e) {
          e.stopPropagation();
          showTaskForm(currentYear, currentMonth, i, day);
        };
        cal.appendChild(day);
      }
    }

// Formulario flotante para agregar tarea a un dÃ­a
function showTaskForm(year, month, dayNum, dayElem) {
      // Evitar mÃºltiples formularios
      if(document.getElementById('calendarTaskForm')) return;
      const form = document.createElement('div');
      form.id = 'calendarTaskForm';
      form.style.position = 'fixed';
      form.style.left = '50%';
      form.style.top = '50%';
      form.style.transform = 'translate(-50%,-50%)';
      form.style.background = '#fff6fb';
      form.style.border = '2px solid #d6336c';
      form.style.boxShadow = '0 6px 18px #d6336c22';
      form.style.padding = '22px 18px 18px 18px';
      form.style.zIndex = 1000;
      form.innerHTML = `
        <div style='font-weight:bold;color:#d6336c;font-size:18px;margin-bottom:10px;'>Agregar tarea para el ${dayNum} de ${getMonthName(month)} ${year}</div>
        <input id='taskTitleInput' type='text' placeholder='TÃ­tulo de la tarea' style='width:100%;margin-bottom:8px;padding:7px;border-radius:8px;border:1px solid #e6e6e6;'>
        <input id='taskHourInput' type='time' style='width:100%;margin-bottom:8px;padding:7px;border-radius:8px;border:1px solid #e6e6e6;'>
        <select id='taskAlarmInput' style='width:100%;margin-bottom:8px;padding:7px;border-radius:8px;border:1px solid #e6e6e6;'>
          <option value='10'>Alarma 10 minutos antes</option>
          <option value='20'>Alarma 20 minutos antes</option>
          <option value='180'>Alarma 3 horas antes</option>
          <option value='0'>Sin alarma</option>
        </select>
        <select id='taskSoundInput' style='width:100%;margin-bottom:8px;padding:7px;border-radius:8px;border:1px solid #e6e6e6;'>
          <option value='bell'>ğŸ”” Campana</option>
          <option value='ding'>ğŸµ Timbre</option>
          <option value='soft'>ğŸŒ¸ MelodÃ­a suave</option>
        </select>
        <div style='font-size:13px;color:#6b7280;margin-bottom:10px;'>La hora de entrega, la alarma y el sonido son opcionales</div>
        <button id='saveTaskBtn' class='btn-primary' style='width:100%;margin-bottom:6px;'>Guardar tarea</button>
        <button id='cancelTaskBtn' class='btn-muted' style='width:100%;'>Cancelar</button>
      `;
      document.body.appendChild(form);
      document.getElementById('taskTitleInput').focus();
      document.getElementById('cancelTaskBtn').onclick = function() {
        form.remove();
      };
      document.getElementById('saveTaskBtn').onclick = function() {
        const title = document.getElementById('taskTitleInput').value.trim();
        const hour = document.getElementById('taskHourInput').value;
        const alarm = parseInt(document.getElementById('taskAlarmInput').value);
        const sound = document.getElementById('taskSoundInput').value;
        if(!title) { alert('Por favor, escribe un tÃ­tulo para la tarea.'); return; }
        saveCalendarTask(year, month, dayNum, title, hour, alarm, sound);
        form.remove();
        generateCalendar();
      };
    }

// Guardar tarea en localStorage
function saveCalendarTask(year, month, dayNum, title, hour, alarm, sound) {
  const key = `calendar-tasks-${year}-${month}`;
  let tasks = JSON.parse(localStorage.getItem(key) || '{}');
  if(!tasks[dayNum]) tasks[dayNum] = [];
  tasks[dayNum].push({title, hour, alarm, sound});
  localStorage.setItem(key, JSON.stringify(tasks));
}

// Sonidos de alarma
const alarmSounds = {
  bell: new Audio('https://cdn.pixabay.com/audio/2022/07/26/audio_124bfae3b2.mp3'), // Campana
  ding: new Audio('https://cdn.pixabay.com/audio/2022/03/15/audio_115b9b7b7b.mp3'), // Timbre
  soft: new Audio('https://cdn.pixabay.com/audio/2022/10/16/audio_12b6b7b7b7.mp3') // MelodÃ­a suave
};


document.getElementById('prevMonth').onclick = function() {
  currentMonth--;
  if(currentMonth<0){currentMonth=11;currentYear--;}
  generateCalendar();
};
document.getElementById('nextMonth').onclick = function() {
  currentMonth++;
  if(currentMonth>11){currentMonth=0;currentYear++;}
  generateCalendar();
};
document.getElementById('prevYear').onclick = function() {
  currentYear--;
  generateCalendar();
};
document.getElementById('nextYear').onclick = function() {
  currentYear++;
  generateCalendar();
};

// Estilo floral para los botones de navegaciÃ³n
const styleFlower = document.createElement('style');
styleFlower.innerHTML = `.btn-flower-nav { background: #fff6fb; color: #d6336c; border: 1.5px solid #d6336c; border-radius: 50%; padding: 7px 13px; font-size: 20px; margin: 0 2px; cursor: pointer; transition: background 0.2s; box-shadow: 0 2px 8px #d6336c22; } .btn-flower-nav:hover { background: #ffe3ef; }`;
document.head.appendChild(styleFlower);

generateCalendar();
</script>
</body>
</html>
